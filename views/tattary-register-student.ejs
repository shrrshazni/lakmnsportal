<%- include('partials/private-header.ejs') %>

<div class="row gy-3 mb-3 justify-content-between d-flex mt-0">
    <div class="col-md-9 col-auto">
        <h2 class="mb-2 text-body-emphasis">Register Student</h2>
        <h5 class="text-body-tertiary fw-semibold">Below is the candidate name list for new student.</h5>
    </div>
</div>

<div class="row justify-content-between mb-6 mt-6">
    <div class="d-flex flex-fill col-md-4 col-xxl-2 text-center border-translucent border-end-0 border-md-end pb-4 pb-xxl-0">
        <div class="flex-grow-1">
            <span class="uil fs-5 lh-1 fa-solid fa-users-line text-primary"></span>
            <h1 class="fs-5 pt-3">180</h1>
            <p class="fs-9 mb-0">Total Candidates</p>
        </div>
    </div>
    <div class="d-flex flex-fill col-md-4 col-xxl-2 text-center border-translucent border-start border-end-0 border-md-end pb-4 pb-xxl-0">
        <div class="flex-grow-1">
            <span class="uil fs-5 lh-1 fa-solid fa-check text-success"></span>
            <h1 class="fs-5 pt-3">15</h1>
            <p class="fs-9 mb-0">Total Approved</p>
        </div>
    </div>
    <div class="d-flex flex-fill col-md-4 col-xxl-2 text-center border-translucent border-start border-end border-end-md-0 pb-4 pb-xxl-0 pt-4 pt-md-0">
        <div class="flex-grow-1">
            <span class="uil fs-5 lh-1 fa-solid fa-clock text-warning"></span>
            <h1 class="fs-5 pt-3">10</h1>
            <p class="fs-9 mb-0">Total Pending</p>
        </div>
    </div>
    <div class="d-flex flex-fill col-md-4 col-xxl-2 text-center border-translucent border-start border-end border-end-md-0 pb-4 pb-xxl-0 pt-4 pt-md-0">
        <div class="flex-grow-1">
            <span class="uil fs-5 lh-1 fa-solid fa-times text-danger"></span>
            <h1 class="fs-5 pt-3">10</h1>
            <p class="fs-9 mb-0">Total Cancelled</p>
        </div>
    </div>
</div>

<!-- New row for option buttons -->
<div class="row gy-3 mb-4 mt-3">
    <div class="d-flex">
        <!-- Button to show register students section -->
        <button id="showRegCandBtn" class="btn btn-primary me-2">Register Candidates</button>
    
        <!-- Button to show candidates waiting List section -->
        <button id="showWaitListBtn" class="btn btn-outline-primary">Waiting List</button>
    </div>
</div>

<!-- Register candidates list table -->
<div id="RegCandSection" class="mx-n4 px-4 mx-lg-n6 px-lg-6 bg-body-emphasis pt-7 pb-3 border-y mb-6">
    <div id="" data-list=''>
        <div class="row align-items-end justify-content-between pb-4 g-3">
            <div class="filters d-flex justify-content-between align-items-center gap-3">
                <!-- Search -->
                <div class="position-relative" style="width: auto;">
                    <span class="fas fa-search search-box-icon" style="position: absolute; top: 50%; left: 10px; transform: translateY(-50%); color: #aaa;"></span>
                    <input type="search" class="form-control ps-5" id="searchInput" placeholder="Search" style="padding: 5px; font-size: 14px; border-radius: 8px; width: 200px;">
                </div>
            </div>
        </div>
        
        <div id="" data-list='{"page":10,"pagination":true}'>
            <div class="table-responsive ms-n1 ps-1 scrollbar">
                <table id="vis-table" class="table fs-9 mb-0 border-top border-translucent">
                    <thead>
                        <tr>
                        <th class="sort align-middle text-start" scope="col" data-sort="" style="width:5%;">CANDIDATE NAME</th>
                        <th class="sort align-middle text-center" scope="col" data-sort="" style="width:15%;">DATE OF BIRTH</th>
                        <th class="sort align-middle text-center" scope="col" data-sort="" style="width:15%;">YEARS OLD</th>
                        <th class="sort align-middle text-center" scope="col" data-sort="" style="width:15%;">DATE OF APPLICATION</th>
                        <th class="sort align-middle text-center" scope="col" data-sort="" style="width:15%;">STATUS</th>
                        <th class="sort align-middle text-end" scope="col" style="width:5%;"></th>
                        </tr>
                    </thead>
                    <tbody id="">
                        <tr>
                            <td class="align-middle text-start">
                                <a href="#" class="student-name text-decoration-none" data-bs-toggle="modal" data-bs-target="#studentModal">My name</a> <!-- Trigger for modal -->
                            </td>
                            <td class="align-middle text-center dob-cell">10-10-2021</td>
                            <td class="align-middle text-center">
                                <span class="badge badge-phoenix badge-phoenix-info fs-10 align-items-center age-badge"></span>
                            </td>
                            <td class="align-middle text-center cursor-pointer text-primary" data-bs-toggle="modal" data-bs-target="#dateModal"">9/10/2024</td>
                            <td class="align-middle text-center">
                                <span class="badge badge-phoenix badge-phoenix-success fs-10 align-items-center">Approved</span>
                            </td>
                            <td class="align-middle text-end white-space-nowrap pe-0 action">
                                <div class="btn-reveal-trigger position-static">
                                    <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs-10" type="button" data-bs-toggle="dropdown" data-boundary="window" aria-haspopup="true" aria-expanded="false" data-bs-reference="parent">
                                        <span class="fas fa-ellipsis-h fs-10"></span>
                                    </button>
                                    <div class="dropdown-menu dropdown-menu-end py-2">
                                        <a class="dropdown-item" href="#" data-bs-toggle="" data-bs-target="">Print</a>
                                        <a class="dropdown-item" href="#" data-bs-toggle="" data-bs-target="">Approval</a>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td class="align-middle text-start">
                                <a href="#" class="student-name text-decoration-none" data-bs-toggle="modal" data-bs-target="#studentModal">Jacky</a> <!-- Trigger for modal -->
                            </td>
                            <td class="align-middle text-center dob-cell">16-06-2020</td>
                            <td class="align-middle text-center">
                                <span class="badge badge-phoenix badge-phoenix-info fs-10 align-items-center age-badge"></span>
                            </td>
                            <td class="align-middle text-center cursor-pointer text-primary" data-bs-toggle="modal" data-bs-target="#dateModal"">9/10/2024</td>
                            <td class="align-middle text-center">
                                <span class="badge badge-phoenix badge-phoenix-warning fs-10 align-items-center">Pending</span>
                            </td>
                            <td class="align-middle text-end white-space-nowrap pe-0 action">
                                <div class="btn-reveal-trigger position-static">
                                    <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs-10" type="button" data-bs-toggle="dropdown" data-boundary="window" aria-haspopup="true" aria-expanded="false" data-bs-reference="parent">
                                        <span class="fas fa-ellipsis-h fs-10"></span>
                                    </button>
                                    <div class="dropdown-menu dropdown-menu-end py-2">
                                        <a class="dropdown-item" href="#" data-bs-toggle="" data-bs-target="">Print</a>
                                        <a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#approvalModal">Approval</a>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td class="align-middle text-start">
                                <a href="#" class="student-name text-decoration-none" data-bs-toggle="modal" data-bs-target="#studentModal">John</a> <!-- Trigger for modal -->
                            </td>
                            <td class="align-middle text-center dob-cell">20-02-2019</td>
                            <td class="align-middle text-center">
                                <span class="badge badge-phoenix badge-phoenix-info fs-10 align-items-center age-badge"></span>
                            </td>
                            <td class="align-middle text-center cursor-pointer text-primary" data-bs-toggle="modal" data-bs-target="#dateModal">9/10/2024</td>
                            <td class="align-middle text-center">
                                <span class="badge badge-phoenix badge-phoenix-danger fs-10 align-items-center">Cancelled</span>
                            </td>
                            <td class="align-middle text-end white-space-nowrap pe-0 action">
                                <div class="btn-reveal-trigger position-static">
                                    <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs-10" type="button" data-bs-toggle="dropdown" data-boundary="window" aria-haspopup="true" aria-expanded="false" data-bs-reference="parent">
                                        <span class="fas fa-ellipsis-h fs-10"></span>
                                    </button>
                                    <div class="dropdown-menu dropdown-menu-end py-2">
                                        <a class="dropdown-item" href="#" data-bs-toggle="" data-bs-target="">Print</a>
                                        <a class="dropdown-item" href="#" data-bs-toggle="" data-bs-target="">Approval</a>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>  
                </table>
            </div>
        </div>
        <div class="row align-items-center justify-content-between py-2 pe-0 fs-9">
            <div class="col-auto d-flex">
                <p class="mb-0 d-none d-sm-block me-3 fw-semibold text-body" data-list-info="data-list-info"></p>
                <a class="fw-semibold" href="#!" data-list-view="*" id="">View all<span class="fas fa-angle-right ms-1" data-fa-transform="down-1"></span></a>
                <a class="fw-semibold d-none" href="#!" data-list-view="less" id="">View Less<span class="fas fa-angle-right ms-1" data-fa-transform="down-1"></span></a>
            </div>
            <div class="col-auto d-flex">
                <button class="page-link" data-list-pagination="prev"><span class="fas fa-chevron-left"></span></button>
                <ul class="mb-0 pagination"></ul>
                <button class="page-link pe-0" data-list-pagination="next"><span class="fas fa-chevron-right"></span></button>
            </div>
        </div>
    </div>
</div>

<!-- Candidates waiting list table -->
<div id="CandWaitSection" class="mx-n4 px-4 mx-lg-n6 px-lg-6 bg-body-emphasis pt-7 pb-3 border-y mb-6 d-none">
    <div id="" data-list=''>
        <div class="row align-items-end justify-content-between pb-4 g-3">
            <div class="filters d-flex justify-content-between align-items-center gap-3">
                <!-- Search -->
                <div class="position-relative" style="width: auto;">
                    <span class="fas fa-search search-box-icon" style="position: absolute; top: 50%; left: 10px; transform: translateY(-50%); color: #aaa;"></span>
                    <input type="search" class="form-control ps-5" id="searchInput" placeholder="Search" style="padding: 5px; font-size: 14px; border-radius: 8px; width: 200px;">
                </div>
            </div>
        </div>
        
        <div id="" data-list='{"page":10,"pagination":true}'>
            <div class="table-responsive ms-n1 ps-1 scrollbar">
                <table id="vis-table" class="table fs-9 mb-0 border-top border-translucent">
                    <thead>
                        <tr>
                        <th class="sort align-middle text-start" scope="col" data-sort="" style="width:5%;">CANDIDATE NAME</th>
                        <th class="sort align-middle text-center" scope="col" data-sort="" style="width:15%;">DATE OF BIRTH</th>
                        <th class="sort align-middle text-center" scope="col" data-sort="" style="width:15%;">YEARS OLD</th>
                        <th class="sort align-middle text-center" scope="col" data-sort="" style="width:15%;">DATE OF APPLICATION</th>
                        <th class="sort align-middle text-center" scope="col" data-sort="" style="width:15%;">STATUS</th>
                        <th class="sort align-middle text-end" scope="col" style="width:5%;"></th>
                        </tr>
                    </thead>
                    <tbody id="">
                        <tr>
                            <td class="align-middle text-start">
                                <a href="#" class="student-name text-decoration-none" data-bs-toggle="modal" data-bs-target="#studentModal">Nur Ain</a> <!-- Trigger for modal -->
                            </td>
                            <td class="align-middle text-center dob-cell">23-11-2019</td>
                            <td class="align-middle text-center">
                                <span class="badge badge-phoenix badge-phoenix-info fs-10 align-items-center age-badge"></span>
                            </td>
                            <td class="align-middle text-center cursor-pointer text-primary" data-bs-toggle="modal" data-bs-target="#dateModal"">23/10/2024</td>
                            <td class="align-middle text-center"><em>In waiting list</em></td>
                            <td class="align-middle text-end white-space-nowrap pe-0 action">
                                <div class="btn-reveal-trigger position-static">
                                    <button class="btn btn-sm dropdown-toggle dropdown-caret-none transition-none btn-reveal fs-10" type="button" data-bs-toggle="dropdown" data-boundary="window" aria-haspopup="true" aria-expanded="false" data-bs-reference="parent">
                                        <span class="fas fa-ellipsis-h fs-10"></span>
                                    </button>
                                    <div class="dropdown-menu dropdown-menu-end py-2">
                                        <a class="dropdown-item" href="#" data-bs-toggle="" data-bs-target="">View</a>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>  
                </table>
            </div>
        </div>
        <div class="row align-items-center justify-content-between py-2 pe-0 fs-9">
            <div class="col-auto d-flex">
                <p class="mb-0 d-none d-sm-block me-3 fw-semibold text-body" data-list-info="data-list-info"></p>
                <a class="fw-semibold" href="#!" data-list-view="*" id="">View all<span class="fas fa-angle-right ms-1" data-fa-transform="down-1"></span></a>
                <a class="fw-semibold d-none" href="#!" data-list-view="less" id="">View Less<span class="fas fa-angle-right ms-1" data-fa-transform="down-1"></span></a>
            </div>
            <div class="col-auto d-flex">
                <button class="page-link" data-list-pagination="prev"><span class="fas fa-chevron-left"></span></button>
                <ul class="mb-0 pagination"></ul>
                <button class="page-link pe-0" data-list-pagination="next"><span class="fas fa-chevron-right"></span></button>
            </div>
        </div>
    </div>
</div>

<!-- Modal to view more student details -->
<div class="modal fade" id="studentModal" tabindex="-1" aria-labelledby="studentModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="studentModalLabel">Student Information</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Information about the student -->
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="fullname" class="form-label"><b>Student Name</b></label>
                        <p class="form-label">Alice Johnson</p>
                    </div>
                    <div class="col-md-6">
                        <label for="address" class="form-label"><b>Address</b></label>
                        <p class="form-label">1234 Elm St, Cityville</p>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="paidAmount" class="form-label"><b>IC Number</b></label>
                        <p class="form-label">990101-12-1234</p>
                    </div>
                    <div class="col-md-6">
                        <label for="paidAmount" class="form-label"><b>Date of Birth</b></label>
                        <p class="form-label">23-10-2013</p>
                    </div>
                </div>
                
                <hr>

                <!-- Information about the student's Parent -->
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="fullname" class="form-label"><b>Father's Name</b></label>
                        <p class="form-label">George</p>
                    </div>
                    <div class="col-md-6">
                        <label for="address" class="form-label"><b>Address</b></label>
                        <p class="form-label">1234 Elm St, Cityville</p>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="paidAmount" class="form-label"><b>IC Number</b></label>
                        <p class="form-label">990101-12-1234</p>
                    </div>
                    <div class="col-md-6">
                        <label for="paidAmount" class="form-label"><b>Phone Number</b></label>
                        <p class="form-label">0123456789</p>
                    </div>
                </div>
                <div class="mb-3">
                    <label for="paidAmount" class="form-label"><b>Occupation</b></label>
                    <p class="form-label">Pilot</p>
                </div>
            
                <hr>

                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="fullname" class="form-label"><b>Mother's Name</b></label>
                        <p class="form-label">Sarah</p>
                    </div>
                    <div class="col-md-6">
                        <label for="address" class="form-label"><b>Address</b></label>
                        <p class="form-label">1234 Elm St, Cityville</p>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="paidAmount" class="form-label"><b>IC Number</b></label>
                        <p class="form-label">990101-12-1234</p>
                    </div>
                    <div class="col-md-6">
                        <label for="paidAmount" class="form-label"><b>Phone Number</b></label>
                        <p class="form-label">0123456789</p>
                    </div>
                </div>
                <div class="mb-3">
                    <label for="paidAmount" class="form-label"><b>Occupation</b></label>
                    <p class="form-label">Nurse</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal for displaying application date details -->
<div class="modal fade" id="dateModal" tabindex="-1" aria-labelledby="dateModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="dateModalLabel">Date Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="fullname" class="form-label"><b>Date of Application</b></label>
                        <p class="form-label">9/10/2024</p>
                    </div>
                    <div class="col-md-6">
                        <label for="address" class="form-label"><b>Time of Application</b></label>
                        <p class="form-label">10:30 AM</p>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="fullname" class="form-label"><b>Location</b></label>
                        <p class="form-label">Kuching, Sarawak</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal to display approval -->
<div class="modal fade" id="approvalModal" tabindex="-1" aria-labelledby="approvalModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="approvalModalLabel">Application Approval</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Do you want to approve this application?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" id="notApproveButton" data-bs-dismiss="modal">Not Approve</button>
                <button type="button" class="btn btn-success" id="approveButton" data-bs-dismiss="modal">Approve</button>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const showRegCandBtn = document.getElementById('showRegCandBtn');
        const showWaitListBtn = document.getElementById('showWaitListBtn');
        const RegCandSection = document.getElementById('RegCandSection');
        const CandWaitSection = document.getElementById('CandWaitSection');

        // Show Class List by default
        showRegCandBtn.classList.add('btn-primary');
        showRegCandBtn.classList.remove('btn-outline-primary');
        showWaitListBtn.classList.add('btn-outline-primary');
        showWaitListBtn.classList.remove('btn-primary');

        // Click event for Class List button
        showRegCandBtn.addEventListener('click', function() {
            RegCandSection.classList.remove('d-none');
            CandWaitSection.classList.add('d-none');

            showRegCandBtn.classList.add('btn-primary');
            showRegCandBtn.classList.remove('btn-outline-primary');
            showWaitListBtn.classList.add('btn-outline-primary');
            showWaitListBtn.classList.remove('btn-primary');
        });

        // Click event for Teacher List button
        showWaitListBtn.addEventListener('click', function() {
            CandWaitSection.classList.remove('d-none');
            RegCandSection.classList.add('d-none');

            showWaitListBtn.classList.add('btn-primary');
            showWaitListBtn.classList.remove('btn-outline-primary');
            showRegCandBtn.classList.add('btn-outline-primary');
            showRegCandBtn.classList.remove('btn-primary');
        });
    });

    // Function to calculate age from date of birth
    function calculateAge(dob) {
        const birthDate = new Date(dob);
        const today = new Date();
        let age = today.getFullYear() - birthDate.getFullYear();
        const monthDiff = today.getMonth() - birthDate.getMonth();

        if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
            age--;
        }
        return age;
    }

    // Function to update the age badge based on the Date of Birth
    function updateAges() {
        const dobElements = document.querySelectorAll('.dob-cell'); // Select all DOB cells
        dobElements.forEach(dobElement => {
            const dob = dobElement.textContent.trim();
            const age = calculateAge(dob.split('-').reverse().join('-')); // Convert DD-MM-YYYY to YYYY-MM-DD format
            const ageBadge = dobElement.nextElementSibling.querySelector('.age-badge'); // Age badge element in the next column
            ageBadge.textContent = `${age} years old`; // Set the age text
        });
    }

    // Call the function on page load
    document.addEventListener('DOMContentLoaded', updateAges);
</script>

<%- include('partials/private-footer.ejs') %>